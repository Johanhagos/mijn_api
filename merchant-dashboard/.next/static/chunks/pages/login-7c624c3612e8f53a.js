(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{3236:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return a(1650)}])},1650:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Login}});var n=a(5893),l=a(7294),o=a(1163),s=a(1842);function Login(){(0,o.useRouter)();let[e,t]=(0,l.useState)(""),[a,r]=(0,l.useState)(""),[i,d]=(0,l.useState)(""),[c,u]=(0,l.useState)(!1),handleLogin=async t=>{t.preventDefault(),d(null),u(!0);try{let t=e.includes("@");console.log("Login attempt:",{isEmail:t,name:t?"":e,email:t?e:void 0});let n=await s.ZP.login(t?"":e,a,t?e:void 0);(null==n?void 0:n.access_token)&&localStorage.setItem("jwt",n.access_token),(null==n?void 0:n.merchant_id)&&localStorage.setItem("merchant_id",String(n.merchant_id)),(null==n?void 0:n.email)&&localStorage.setItem("merchant_email",String(n.email)),window.location.href="/dashboard"}catch(e){console.error("Login error:",e),d(e.message||"Login failed")}finally{u(!1)}},[h,m]=(0,l.useState)(""),[g,p]=(0,l.useState)(!1),[f,x]=(0,l.useState)(null),[b,w]=(0,l.useState)(null),handleForgot=async()=>{w(null),x(null),p(!0);try{let e=await fetch("".concat("https://api.apiblockchain.io","/forgot_password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:h})});if(!e.ok)throw Error("Request failed");let t=await e.json();x(t.password||"")}catch(e){w((null==e?void 0:e.message)||"Failed to reset password")}finally{p(!1)}};return(0,n.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:(0,n.jsxs)("form",{onSubmit:handleLogin,className:"bg-white p-8 rounded shadow-md w-96 flex flex-col gap-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Merchant Login"}),i&&(0,n.jsx)("p",{className:"text-red-600",children:i}),(0,n.jsx)("input",{type:"text",placeholder:"Username or Email",value:e,onChange:e=>t(e.target.value),className:"border p-2 rounded",required:!0}),(0,n.jsx)("input",{type:"password",placeholder:"Password",value:a,onChange:e=>r(e.target.value),className:"border p-2 rounded",required:!0}),(0,n.jsx)("button",{disabled:c,className:"bg-blue-600 text-white p-2 rounded hover:bg-blue-700 disabled:opacity-50",children:c?"Logging in…":"Login"}),(0,n.jsxs)("div",{className:"mt-4 border-t pt-4",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Forgot your password?"}),(0,n.jsxs)("div",{className:"flex gap-2 mt-2",role:"form",children:[(0,n.jsx)("input",{type:"text",placeholder:"Email or username",value:h,onChange:e=>m(e.target.value),className:"border p-2 rounded flex-1"}),(0,n.jsx)("button",{type:"button",onClick:handleForgot,disabled:g,className:"bg-gray-600 text-white p-2 rounded",children:g?"Sending…":"Reset"})]}),b&&(0,n.jsx)("p",{className:"text-red-600 mt-2",children:b}),f&&(0,n.jsxs)("p",{className:"text-green-600 mt-2",children:["Temporary password: ",f]})]})]})})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=3236)}),_N_E=e.O()}]);