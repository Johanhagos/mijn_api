(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{6840:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return a(4938)}])},1842:function(e,t,a){"use strict";let n="https://api.apiblockchain.io",api=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2?arguments[2]:void 0,o=localStorage.getItem("jwt"),r="".concat(n).concat(e),l=await fetch(r,{method:t,headers:{"Content-Type":"application/json",...o?{Authorization:"Bearer ".concat(o)}:{}},body:a?JSON.stringify(a):void 0,credentials:"include"});if(!l.ok)throw Error(await l.text());return l.json()},login=async(e,t)=>{let a=await fetch("".concat(n,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,password:t}),credentials:"include"});if(!a.ok)throw Error(await a.text());let o=await a.json();return(null==o?void 0:o.access_token)&&(localStorage.setItem("jwt",o.access_token),(null==o?void 0:o.merchant_id)&&localStorage.setItem("merchant_id",String(o.merchant_id)),((null==o?void 0:o.merchant_name)||(null==o?void 0:o.merchant))&&localStorage.setItem("merchant_name",String(o.merchant_name||o.merchant)),(null==o?void 0:o.email)&&localStorage.setItem("merchant_email",String(o.email))),o},protectedApi=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2?arguments[2]:void 0,o=localStorage.getItem("jwt"),r="".concat(n).concat(e),doRequest=async e=>{let n={"Content-Type":"application/json"};return e&&(n.Authorization="Bearer ".concat(e)),fetch(r,{method:t,headers:n,body:a?JSON.stringify(a):void 0,credentials:"include"})},l=await doRequest(o||void 0);if(401===l.status){let e=await fetch("".concat(n,"/refresh"),{method:"POST",credentials:"include"});if(e.ok){let t=await e.json(),a=(null==t?void 0:t.access_token)||(null==t?void 0:t.token);a&&(localStorage.setItem("jwt",a),l=await doRequest(a))}}if(401===l.status)throw localStorage.removeItem("jwt"),localStorage.removeItem("merchant_id"),localStorage.removeItem("merchant_name"),localStorage.removeItem("merchant_email"),window.location.href="/login",Error("Unauthorized");if(!l.ok)throw Error(await l.text());return l.json()};t.ZP={api,login,protectedApi}},4938:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return MyApp}});var n=a(5893);a(415);var o=a(7294),r=a(1163),l=a(1842);function Header(){(0,r.useRouter)();let[e,t]=(0,o.useState)(!1),[a,c]=(0,o.useState)(null),[i,s]=(0,o.useState)(null);return((0,o.useEffect)(()=>{t(!0);try{let e=localStorage.getItem("merchant_email");s(e);let t=localStorage.getItem("merchant_name");c(t)}catch(e){}let e=!0;return(async()=>{try{let t=await l.ZP.protectedApi("/merchant/me");if(!e)return;c((null==t?void 0:t.name)||(null==t?void 0:t.merchant_name)||(null==t?void 0:t.display_name)||"Merchant"),s((null==t?void 0:t.email)||(null==t?void 0:t.merchant_email)||(null==t?void 0:t.contact_email)||null)}catch(t){try{let t=await l.ZP.protectedApi("/merchant/usage");if(!e)return;c((null==t?void 0:t.merchant_name)||(null==t?void 0:t.merchant)||"Merchant"),s((null==t?void 0:t.merchant_email)||(null==t?void 0:t.email)||null)}catch(e){}}})(),()=>{e=!1}},[]),e)?(0,n.jsxs)("header",{className:"flex justify-between items-center p-4 border-b shadow-sm",style:{background:"#FFFFFF"},children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)("div",{className:"h-10 w-10 flex items-center justify-center rounded bg-gradient-to-br from-primary to-secondary text-white font-extrabold tracking-tight",children:(0,n.jsx)("span",{className:"text-sm",children:"APIBl"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:"Dashboard â€” Invoicing Merchant"}),i?(0,n.jsx)("p",{className:"text-sm text-slate-600",children:i}):null]})]}),(0,n.jsx)("button",{onClick:function(){localStorage.removeItem("token"),localStorage.removeItem("jwt"),localStorage.removeItem("merchant_id"),localStorage.removeItem("merchant_name"),localStorage.removeItem("merchant_email"),window.location.href="/login"},className:"ml-auto btn btn-ghost",children:"Logout"})]}):(0,n.jsx)("header",{className:"h-16",style:{background:"var(--ab-surface)"}})}function MyApp(e){let{Component:t,pageProps:a}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Header,{}),(0,n.jsx)(t,{...a})]})}},415:function(){},1163:function(e,t,a){e.exports=a(9974)}},function(e){var __webpack_exec__=function(t){return e(e.s=t)};e.O(0,[774,179],function(){return __webpack_exec__(6840),__webpack_exec__(9974)}),_N_E=e.O()}]);